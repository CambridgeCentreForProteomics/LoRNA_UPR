---
title: "Parse MERFISH"
author:
  - name: "Tom Smith"
    affiliation: "Cambridge Centre for Proteomics"
date: "`r format(Sys.time(), '%d %B, %Y')`"
abstract: | 
  Here, we parse Xia et al MERFISH data
output:
  pdf_document:
  html_notebook: default
geometry: margin=1in
fontsize: 11pt
---

```{r}
library(tidyverse)
library(camprotR)
library(biomaRt)
```



```{r}
xia_et_al_tx_map <- read.table('./pnas.1912459116.sd01.csv', sep=',', header=1)  %>% filter(!grepl('^Blank', name)) %>% dplyr::select(name, id) %>%
  mutate(ensembl_transcript_id=gsub('\\.\\d+', '', id))
```

```{r}
xia_et_al_er <- readxl::read_excel('./pnas.1912459116.sd04.xlsx', sheet=2) %>% filter(!grepl('^Blank', Gene)) %>%
   merge(xia_et_al_tx_map, by.x='Gene',by.y='name')
```



```{r}
xia_et_al_nuc <- readxl::read_excel('./pnas.1912459116.sd06.xlsx', sheet=2) %>% filter(!grepl('^Blank', Gene)) %>%
   merge(xia_et_al_tx_map, by.x='Gene',by.y='name')
print(nrow(xia_et_al_nuc))
```



```{r}
saveRDS(xia_et_al_er, './out/xia_et_al_er.rds')

saveRDS(xia_et_al_nuc, './out/xia_et_al_nuc.rds')
```

